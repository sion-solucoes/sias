/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.sias.model.dao.relatorios.impl;

import com.sias.model.constants.mcf.FamiliaConstants;
import com.sias.model.constants.mcf.FamiliaMembroConstants;
import com.sias.model.dao.relatorios.interfaces.RelatorioMensalAtendimentoDAO;
import com.sias.model.entity.mca.UnidadeAtendimento;
import com.sias.model.entity.relatorios.RelatorioMensalAtendimento;
import com.sias.model.rowmapper.relatorios.RelatorioMensalAtendimentoRowMapper;
import com.sias.util.JDBCBaseDAO;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import org.springframework.stereotype.Repository;

/**
 *
 * @author Fernando
 */
@Repository
public class RelatorioMensalAtendimentoDAOImpl extends JDBCBaseDAO implements RelatorioMensalAtendimentoDAO {

    @Override
    public RelatorioMensalAtendimento getRelatorioMensalAtendimento(UnidadeAtendimento unidadeAtendimento, Date dataInicial, Date dataFinal) throws Exception {

        List<Object> params = new ArrayList<Object>();

        StringBuffer query = new StringBuffer();
        query.append("SELECT ");
        query.append("(SELECT COUNT(DISTINCT(" + FamiliaConstants.ID + ")) FROM " + FamiliaConstants.TABELA + " WHERE " + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ) total_familias, ");

        params.add(unidadeAtendimento.getId());

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " WHERE " + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ) total_individuos, ");

        params.add(unidadeAtendimento.getId());

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaConstants.ID + ")) FROM " + FamiliaConstants.TABELA + " WHERE " + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? AND " + FamiliaConstants.DATA_INCLUSAO + " >= ? AND " + FamiliaConstants.DATA_INCLUSAO + " <= ? ) novas_familias, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " WHERE " + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ) novos_individuos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaConstants.ID + ")) FROM " + FamiliaConstants.TABELA + " LEFT JOIN familia_membro ON " + FamiliaConstants.ID + " = " + FamiliaMembroConstants.FAMILIA_ID + " WHERE " + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? AND " + FamiliaConstants.DATA_INCLUSAO + " >= ? AND " + FamiliaConstants.DATA_INCLUSAO + " <= ? AND " + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE)  familia_trabalho_infantil, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE < ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_masculino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_masculino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_feminino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_IDOSO_PCD + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimadas_feminino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_violencia_intrafamiliar, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_violencia_intrafamiliar_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_violencia_intrafamiliar_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ?::DATE AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_violencia_intrafamiliar_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_violencia_intrafamiliar_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_exploracao_sexual, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_exploracao_sexual_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_exploracao_sexual_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_exploracao_sexual_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_exploracao_sexual_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_abuso_sexual, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_abuso_sexual_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_abuso_sexual_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_abuso_sexual_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_abuso_sexual_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_negligencia_abandono, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_negligencia_abandono_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_negligencia_abandono_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_negligencia_abandono_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_negligencia_abandono_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 15 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_trabalho_infantil, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_trabalho_infantil_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 15 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_trabalho_infantil_masculino_13_a_15_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_trabalho_infantil_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 15 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRABALHO_INFANTIL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_criancas_vitimas_trabalho_infantil_feminino_13_a_15_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_violencia_intrafamiliar, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_violencia_intrafamiliar_masculino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_violencia_intrafamiliar_feminino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_negligencia_abandono, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_negligencia_abandono_masculino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_idosos_vitimas_negligencia_abandono_feminino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_masculino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_masculino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_feminino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_violencia_intrafamiliar_feminino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_masculino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_masculino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_feminino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DEFICIENCIA_ID + " IS NOT NULL ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.NEGLIGENCIA_ABANDONO + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_deficientes_vitimas_negligencia_abandono_feminino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_adultos_vitimas_violencia_intrafamiliar, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_adultos_vitimas_violencia_intrafamiliar_masculino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_FISICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.VIOLENCIA_PSICOLOGICA + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.EXPLORACAO_SEXUAL + " IS TRUE ");
        query.append("		OR ");
        query.append("		" + FamiliaMembroConstants.ABUSO_VIOLENCIA_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novos_adultos_vitimas_violencia_intrafamiliar_feminino, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_masculino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_masculino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_feminino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAJETORIA_RUA + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trajetoria_rua_feminino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_masculino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_masculino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_masculino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_masculino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 0 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 12 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_feminino_0_a_12_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 13 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 17 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_feminino_13_a_17_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 18 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) <= 59 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_feminino_18_a_59_anos, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.SEXO + " = 1 ");
        query.append("		AND ");
        query.append("		(SELECT EXTRACT(YEAR FROM AGE(" + FamiliaMembroConstants.DATA_NASCIMENTO + "))) >= 60 ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.TRAFICO_PESSOAS + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_trafico_feminino_60_anos_ou_mais, ");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        query.append("(SELECT COUNT(DISTINCT(" + FamiliaMembroConstants.ID + ")) FROM " + FamiliaMembroConstants.TABELA + " LEFT JOIN familia ON " + FamiliaMembroConstants.FAMILIA_ID + " = " + FamiliaConstants.ID + " ");
        query.append("	WHERE ");
        query.append("		" + FamiliaConstants.UNIDADE_ATENDIMENTO_ID + " = ? ");
        query.append("		AND ");
        query.append("		" + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE >= ? AND " + FamiliaMembroConstants.DATA_INCLUSAO + "::DATE <= ? ");
        query.append("		AND ");
        query.append("		( ");
        query.append("		" + FamiliaMembroConstants.DISCRIMINACAO_ORIENTACAO_SEXUAL + " IS TRUE ");
        query.append("		) ");
        query.append(") novas_pessoas_vitimas_discriminacao_orientacao_sexual");

        params.add(unidadeAtendimento.getId());
        params.add(dataInicial);
        params.add(dataFinal);

        Object args[] = params.toArray();

        return getTemplate().queryForObject(query.toString(), args, new RelatorioMensalAtendimentoRowMapper());
    }

}
